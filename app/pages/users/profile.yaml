id: profile
type: PageHeaderMenu
properties:
  _ref:
    path: shared/header.yaml
    vars:
      headerTitle: Profil

requests:
  - _ref: pages/users/requests/change_role.yaml

layout:
  contentJustify: center
areas:
  footer:
    blocks: 
      - _ref: shared/footer.yaml
  header:
    blocks:
      - _ref: shared/users/user_avatar.yaml
blocks:
  - id: title
    type: Title
    style:
      textAlign: center
    properties:
      content: Profile
      level: 2
  - id: content_card
    type: Card
    layout:
      size: 600
      contentGutter: 16
      contentJustify: center
    blocks:
      - id: avatar
        type: Avatar
        layout:
          size: auto
        properties:
          size: 120
          src:
            _if_none:
              - _user: profile.picture
              - _user: image
          alt:
            _user: name
      - id: details
        type: Descriptions
        properties:
          bordered: true
          column: 2
          items:
            - _ref:
                path: pages/users/components/label_user_not_set.yaml
                vars:
                  labelData: Email
                  userData: email
            - _ref:
                path: pages/users/components/label_user_not_set.yaml
                vars:
                  labelData: Nama
                  userData: profile.name
            - _ref:
                path: pages/users/components/label_user_not_set.yaml
                vars:
                  labelData: 
                    _if_none:
                      - _user: identity.type
                      - No Identifikasi
                  userData: identity.number
            - _ref:
                path: pages/users/components/label_user_not_set.yaml
                vars:
                  labelData: Jurusan
                  userData: identity.prodi
      - id: edit_profile_button
        type: Button
        layout:
          span: 12
        properties:
          title: Edit Profile
          # shape: round
          icon: AiOutlineEdit
          block: true
        events:
          onClick:
            - id: edit_profile_link
              type: Link
              params: edit-profile
      - id: logout_button
        type: Button
        layout:
          span: 12
        properties:
          title: Logout
          # shape: round
          icon: AiOutlineLogout
          type: default
          block: true
        events:
          onClick:
            - id: logout
              type: Logout
              params:
                callbackUrl:
                  url: AUTH0_LOGOUT
      - id: box_change_role
        type: Box
        layout:
          contentGutter: 15
        visible:
          _ne:
            - _user: roles-all.1
            - null
        blocks:
          - id: change_roles
            type: Selector
            properties:
              title: Active Roles (Pilih untuk merubah)
              allowClear: false
              options:
                # _log:
                  _user: roles-all
                # _array.concat:
                #   - _user: add_roles
                #   - _user: roles
                # _array.map:
                #   - _user: add_roles
                #   - _function:
                #       value:
                #         __args: 0
            events:
              onMount:
                - id: default_state
                  type: SetState
                  params:
                    change_roles:
                      _user: roles
          - id: change_role_button
            type: Button
            properties:
              title: Change Role
              # shape: round
              icon: AiOutlineEdit
              block: true
            events:
              onClick:
                - id: change_role
                  type: Request
                  params: change_role
                - id: update_user_id_token
                  type: Login
                  params:
                    callbackUrl:
                      pageId: profile
          # - id: custom_button
          #   type: CustomButton
          #   properties:
          #     title: Custom Button
          #     # shape: round
          #     icon: AiOutlineEdit
          #     block: true
